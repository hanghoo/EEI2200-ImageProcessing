close all
clear all

I = imread('lenna_16graylevel.jpg');
figure, imshow(I)

J=I/16; % 16 grades
K=zeros(1024,1024); % new image

for i=1:256
   for j=1:256
       switch J(i,j) % match with 16 gray-levels by using cluster of pixels
           case 1
           case 2
               K(4*i-3,4*j-3)=1;
           case 3
               K(4*i-3,4*j-3)=1;K(4*i-2,4*j-2)=1;
           case 4
               K(4*i-3,4*j-3)=1;K(4*i-2,4*j-2)=1;K(4*i-1,4*j-1)=1;
           case 5
               K(4*i-3,4*j-3)=1;K(4*i-2,4*j-2)=1;K(4*i-1,4*j-1)=1;K(4*i,4*j)=1;
           case 6
               K(4*i-3,4*j-3)=1;K(4*i-2,4*j-2)=1;K(4*i-1,4*j-1)=1;K(4*i,4*j)=1;
               K(4*i-2,4*j-1)=1;
           case 7
               K(4*i-3,4*j-3)=1;K(4*i-2,4*j-2)=1;K(4*i-1,4*j-1)=1;K(4*i,4*j)=1;
               K(4*i-2,4*j-1)=1;K(4*i-3,4*j-2)=1;
           case 8
               K(4*i-3,4*j-3)=1;K(4*i-2,4*j-2)=1;K(4*i-1,4*j-1)=1;K(4*i,4*j)=1;
               K(4*i-2,4*j-1)=1;K(4*i-3,4*j-2)=1;K(4*i-1,4*j)=1;
           case 9
               K(4*i-3,4*j-3)=1;K(4*i-2,4*j-2)=1;K(4*i-1,4*j-1)=1;K(4*i,4*j)=1;
               K(4*i-2,4*j-1)=1;K(4*i-3,4*j-2)=1;K(4*i-1,4*j)=1;K(4*i-3,4*j-1)=1;
           case 10
               K(4*i-3,4*j-3)=1;K(4*i-2,4*j-2)=1;K(4*i-1,4*j-1)=1;K(4*i,4*j)=1;
               K(4*i-2,4*j-1)=1;K(4*i-3,4*j-2)=1;K(4*i-1,4*j)=1;K(4*i-3,4*j-1)=1;
               K(4*i-2,4*j)=1;
           case 11
               K(4*i-3,4*j-3)=1;K(4*i-2,4*j-2)=1;K(4*i-1,4*j-1)=1;K(4*i,4*j)=1;
               K(4*i-2,4*j-1)=1;K(4*i-3,4*j-2)=1;K(4*i-1,4*j)=1;K(4*i-3,4*j-1)=1;
               K(4*i-2,4*j)=1;K(4*i-3,4*j)=1;
           case 12
               K(4*i-3,4*j-3)=1;K(4*i-2,4*j-2)=1;K(4*i-1,4*j-1)=1;K(4*i,4*j)=1;
               K(4*i-2,4*j-1)=1;K(4*i-3,4*j-2)=1;K(4*i-1,4*j)=1;K(4*i-3,4*j-1)=1;
               K(4*i-2,4*j)=1;K(4*i-3,4*j)=1;K(4*i-2,4*j-3)=1;
           case 13
               K(4*i-3,4*j-3)=1;K(4*i-2,4*j-2)=1;K(4*i-1,4*j-1)=1;K(4*i,4*j)=1;
               K(4*i-2,4*j-1)=1;K(4*i-3,4*j-2)=1;K(4*i-1,4*j)=1;K(4*i-3,4*j-1)=1;
               K(4*i-2,4*j)=1;K(4*i-3,4*j)=1;K(4*i-2,4*j-3)=1;K(4*i-1,4*j-2)=1;
           case 14
               K(4*i-3,4*j-3)=1;K(4*i-2,4*j-2)=1;K(4*i-1,4*j-1)=1;K(4*i,4*j)=1;
               K(4*i-2,4*j-1)=1;K(4*i-3,4*j-2)=1;K(4*i-1,4*j)=1;K(4*i-3,4*j-1)=1;
               K(4*i-2,4*j)=1;K(4*i-3,4*j)=1;K(4*i-2,4*j-3)=1;K(4*i-1,4*j-2)=1;
               K(4*i-1,4*j-3)=1;
           case 15
               K(4*i-3,4*j-3)=1;K(4*i-2,4*j-2)=1;K(4*i-1,4*j-1)=1;K(4*i,4*j)=1;
               K(4*i-2,4*j-1)=1;K(4*i-3,4*j-2)=1;K(4*i-1,4*j)=1;K(4*i-3,4*j-1)=1;
               K(4*i-2,4*j)=1;K(4*i-3,4*j)=1;K(4*i-2,4*j-3)=1;K(4*i-1,4*j-2)=1;
               K(4*i-1,4*j-3)=1;K(4*i,4*j-2)=1;
           case 16
               K(4*i-3,4*j-3)=1;K(4*i-2,4*j-2)=1;K(4*i-1,4*j-1)=1;K(4*i,4*j)=1;
               K(4*i-2,4*j-1)=1;K(4*i-3,4*j-2)=1;K(4*i-1,4*j)=1;K(4*i-3,4*j-1)=1;
               K(4*i-2,4*j)=1;K(4*i-3,4*j)=1;K(4*i-2,4*j-3)=1;K(4*i-1,4*j-2)=1;
               K(4*i-1,4*j-3)=1;K(4*i,4*j-2)=1;K(4*i,4*j-1)=1;
       end
   end
end

% display K and save
figure, imshow(K)
imwrite(K,"lenna_halftone.jpg")
        